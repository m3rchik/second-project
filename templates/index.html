<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="–ù–æ–≤–æ—Å—Ç–Ω–æ–π –ø–æ—Ä—Ç–∞–ª —Å –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –ª–µ–Ω—Ç–æ–π –Ω–æ–≤–æ—Å—Ç–µ–π">
    <title>–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è - –ù–æ–≤–æ—Å—Ç–Ω–æ–π –ø–æ—Ä—Ç–∞–ª</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}" media="all">
    <link rel="preload" href="{{ url_for('static', filename='images/landscape.jpg') }}" as="image">
    <link rel="dns-prefetch" href="//newsapi.org">
</head>
<body>
    <div class="auth-container glass-effect">
        <h1>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</h1>
        
        {% with messages = get_flashed_messages() %}
            {% if messages %}
            <div class="messages">
                {% for message in messages %}
                    <div class="message">{{ message }}</div>
                {% endfor %}
            </div>
            {% endif %}
        {% endwith %}

        <div class="auth-tabs">
            <button class="tab-button active" data-tab="login">–í—Ö–æ–¥</button>
            <button class="tab-button" data-tab="register">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
        </div>

        <form method="POST" id="login-form" class="auth-form">
            <div class="form-group">
                <input type="text" name="login" class="form-input" placeholder="Email –∏–ª–∏ –ø—Å–µ–≤–¥–æ–Ω–∏–º *" required>
            </div>
            <div class="form-group">
                <input type="password" name="password" class="form-input" placeholder="–ü–∞—Ä–æ–ª—å *" required>
            </div>
            <button type="submit" name="action" value="login" class="button">–í–æ–π—Ç–∏</button>
            <div class="forgot-password">
                <button type="button" class="button" data-action="reset">–ó–∞–±—ã–ª–∏ –ø–∞—Ä–æ–ª—å?</button>
            </div>
        </form>

        <form method="POST" action="{{ url_for('request_reset') }}" id="reset-form" class="auth-form reset-form hidden">
            <h2>–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è</h2>
            <div class="form-group">
                <input type="email" name="email" class="form-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à email" required>
            </div>
            <div class="form-buttons">
                <button type="submit" class="button">–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–∞—Ä–æ–ª—å</button>
                <button type="button" class="button cancel-button" data-action="cancel-reset">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </form>

        <form method="POST" id="register-form" class="auth-form hidden" novalidate>
            <div class="form-group">
                <input type="email" name="login" class="form-input" placeholder="Email *" required>
            </div>
            <div class="form-group password-group">
                <input type="password" name="password" id="register-password" 
                       class="form-input"
                       placeholder="–ü–∞—Ä–æ–ª—å *" required
                       pattern="^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&\-_])[A-Za-z\d@$!%*?&\-_]{8,}$">
                <div class="password-requirements">
                    <p>–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –ø–∞—Ä–æ–ª—é:</p>
                    <ul>
                        <li id="length">–ú–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤</li>
                        <li id="lowercase">–°—Ç—Ä–æ—á–Ω—ã–µ –±—É–∫–≤—ã (a-z)</li>
                        <li id="uppercase">–ó–∞–≥–ª–∞–≤–Ω—ã–µ –±—É–∫–≤—ã (A-Z)</li>
                        <li id="number">–¶–∏—Ñ—Ä—ã (0-9)</li>
                        <li id="special">–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã (@$!%*?&-_)</li>
                    </ul>
                </div>
            </div>
            <div class="form-group">
                <input type="text" name="nickname" class="form-input" placeholder="–ü—Å–µ–≤–¥–æ–Ω–∏–º">
                <div class="field-hint">–ö–∞–∫ –≤–∞—Å –±—É–¥—É—Ç –≤–∏–¥–µ—Ç—å –¥—Ä—É–≥–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</div>
            </div>
            <div class="form-group">
                <input type="tel" name="phone" class="form-input" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω" pattern="[0-9+\s-()]*">
                <div class="field-hint">–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ</div>
            </div>
            <button type="submit" name="action" value="register" class="button">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
        </form>
    </div>

    <div class="features">
        <div class="feature glass-effect">
            <div class="feature-icon">üì∞</div>
            <h3>–ê–∫—Ç—É–∞–ª—å–Ω—ã–µ –Ω–æ–≤–æ—Å—Ç–∏</h3>
            <p>–ë—É–¥—å—Ç–µ –≤ –∫—É—Ä—Å–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å–æ–±—ã—Ç–∏–π –∏–∑ —Ä–∞–∑–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π</p>
        </div>
        <div class="feature glass-effect">
            <div class="feature-icon">üîç</div>
            <h3>–£–¥–æ–±–Ω—ã–π –ø–æ–∏—Å–∫</h3>
            <p>–ù–∞—Ö–æ–¥–∏—Ç–µ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–∏–µ –≤–∞—Å –Ω–æ–≤–æ—Å—Ç–∏ –±—ã—Å—Ç—Ä–æ –∏ –ª–µ–≥–∫–æ</p>
        </div>
        <div class="feature glass-effect">
            <div class="feature-icon">üì±</div>
            <h3>–í—Å–µ–≥–¥–∞ –Ω–∞ —Å–≤—è–∑–∏</h3>
            <p>–ß–∏—Ç–∞–π—Ç–µ –Ω–æ–≤–æ—Å—Ç–∏ —Å –ª—é–±–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞</p>
        </div>
        <div class="feature glass-effect">
            <div class="feature-icon">üåê</div>
            <h3>–ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è</h3>
            <p>–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ª–µ–Ω—Ç—É –Ω–æ–≤–æ—Å—Ç–µ–π –ø–æ–¥ —Å–≤–æ–∏ –∏–Ω—Ç–µ—Ä–µ—Å—ã</p>
        </div>
    </div>

    <script>
        // –ò—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π
        document.addEventListener('DOMContentLoaded', () => {
            const forms = {
                login: document.getElementById('login-form'),
                register: document.getElementById('register-form'),
                reset: document.getElementById('reset-form')
            };
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–æ–≤ –ø–æ –∫–Ω–æ–ø–∫–∞–º —Ç–∞–±–æ–≤
            document.querySelector('.auth-tabs').addEventListener('click', (e) => {
                if (e.target.classList.contains('tab-button')) {
                    const tabName = e.target.dataset.tab;
                    showTab(tabName);
                }
            });
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–Ω–æ–ø–æ–∫ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–∞—Ä–æ–ª—è
            document.addEventListener('click', (e) => {
                if (e.target.dataset.action === 'reset') {
                    toggleResetForm(true);
                } else if (e.target.dataset.action === 'cancel-reset') {
                    toggleResetForm(false);
                }
            });
            
            // –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–æ–ª—è –ø—Ä–∏ –≤–≤–æ–¥–µ (—Å debounce)
            let timeout;
            const passwordInput = document.getElementById('register-password');
            if (passwordInput) {
                passwordInput.addEventListener('input', (e) => {
                    clearTimeout(timeout);
                    timeout = setTimeout(() => checkPassword(e.target.value), 300);
                });
            }
            
            // –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º—ã —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
            const registerForm = document.getElementById('register-form');
            if (registerForm) {
                registerForm.addEventListener('submit', (e) => {
                    if (!validatePassword()) {
                        e.preventDefault();
                    }
                });
            }
            
            function showTab(tabName) {
                const buttons = document.querySelectorAll('.tab-button');
                buttons.forEach(btn => {
                    btn.classList.toggle('active', btn.dataset.tab === tabName);
                });
                
                Object.entries(forms).forEach(([name, form]) => {
                    form.classList.toggle('hidden', name !== tabName);
                });
            }
            
            function toggleResetForm(show) {
                const authTabs = document.querySelector('.auth-tabs');
                const messages = document.querySelector('.messages');
                
                forms.reset.classList.toggle('hidden', !show);
                forms.login.classList.toggle('hidden', show);
                forms.register.classList.toggle('hidden', true);
                authTabs.classList.toggle('hidden', show);
                if (messages) messages.classList.toggle('hidden', show);
            }
            
            function checkPassword(password) {
                const requirements = {
                    length: password.length >= 8,
                    lowercase: /[a-z]/.test(password),
                    uppercase: /[A-Z]/.test(password),
                    number: /[0-9]/.test(password),
                    special: /[@$!%*?&\-_]/.test(password)
                };

                Object.entries(requirements).forEach(([req, met]) => {
                    const element = document.getElementById(req);
                    element.classList.toggle('met', met);
                    element.classList.toggle('unmet', !met);
                });
            }
            
            function validatePassword() {
                const password = document.getElementById('register-password').value;
                const requirements = {
                    length: password.length >= 8,
                    lowercase: /[a-z]/.test(password),
                    uppercase: /[A-Z]/.test(password),
                    number: /[0-9]/.test(password),
                    special: /[@$!%*?&\-_]/.test(password)
                };

                const allRequirementsMet = Object.values(requirements).every(met => met);
                
                if (!allRequirementsMet) {
                    alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–∞—Ä–æ–ª—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –≤—Å–µ–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º');
                    return false;
                }
                
                return true;
            }
        });
    </script>
</body>
</html> 